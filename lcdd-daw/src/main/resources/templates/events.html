{{>header}}

<main class="main">
  <section id="projects" class="projects section">

    <div class="container" data-aos="fade-up">
      <div class="form-intro text-center mb-5 mt-4">
        <h1 style="font-weight: 700; color: #212529; text-transform: uppercase;">Próximos Eventos</h1>
        <p class="text-muted">Participa en nuestras partidas, torneos y quedadas</p>
        <hr style="width: 50px; margin: 20px auto; border-top: 3px solid #a71b12; opacity: 1;">
      </div>

      <div class="card shadow-sm border-0 p-3 bg-light mb-5">
        <form method="get" action="/events">
          <div class="row g-2 align-items-center">
            <div class="col-lg-6 col-md-5">
              <input name="name" class="form-control" type="search" placeholder="Buscar eventos por nombre..."
                value="{{name}}">
            </div>
            <div class="col-lg-2 col-md-3">
              <select name="tag" class="form-select">
                <option value="">Categoría</option>
                <option value="Juegos de mesa">Juegos de mesa</option>
                <option value="Rol">Rol</option>
                <option value="Cartas">Cartas</option>
              </select>
            </div>

            <div class="col-lg-2 col-md-2">
              <button class="btn_lcdd w-100 d-flex align-items-center justify-content-center" type="submit"
                style="height: 38px; border: none;">
                <i class="bi bi-search me-2"></i> Buscar
              </button>
            </div>

            {{#logged}}
            <div class="col-lg-2 col-md-2">
              <a href="/event_form"
                class="btn_lcdd_black w-100 text-decoration-none d-flex align-items-center justify-content-center"
                style="height: 38px;">
                <i class="bi bi-plus-circle me-2"></i> Crear
              </a>
            </div>
            {{/logged}}
          </div>
        </form>
      </div>

      <div id="events-container" class="row gy-4">
        {{#event}}
        <div class="col-lg-4 col-md-6 event-item">
          <div class="project-card h-100 shadow-sm border-0">
            <a href="/event/{{eventId}}" class="text-decoration-none">
              <div class="project-image" style="height: 220px; overflow: hidden;">
                {{#eventImage}}
                <img src="/images/{{id}}" alt="{{eventName}}" class="img-fluid w-100 h-100" style="object-fit: cover;">
                {{/eventImage}}
                {{^eventImage}}
                <div class="bg-secondary w-100 h-100 d-flex align-items-center justify-content-center text-white">
                  <i class="bi bi-calendar-event fs-1"></i>
                </div>
                {{/eventImage}}
              </div>
              <div class="project-info p-3">
                <div class="project-category mb-2 fw-bold" style="color: #a71b12; font-size: 0.8rem;">{{eventTag}}</div>
                <h4 class="project-title text-dark">{{eventName}}</h4>
                <p class="project-description text-muted small"
                  style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; word-break: break-all;">
                  {{eventDescription}}
                </p>
              </div>
            </a>
          </div>
        </div>
        {{/event}}

        {{^event}}
        <div class="col-12 text-center py-5">
          <i class="bi bi-calendar-x fs-1 text-muted"></i>
          <p class="mt-3 text-muted">No hay eventos que coincidan con tu búsqueda.</p>
          <a href="/events" class="btn btn-link text-danger">Ver todos los eventos</a>
        </div>
        {{/event}}
      </div>

      <div class="text-center mt-5 mb-5">
        {{#hasNext}}
        <button id="load-more-events-btn" class="btn-load-more" onclick="loadMoreEvents()" data-name="{{name}}"
          data-tag="{{tag}}">
          <span id="btn-events-text">Cargar más eventos</span>
          <span id="btn-events-spinner" class="spinner-border spinner-border-sm d-none" role="status"></span>
        </button>
        {{/hasNext}}
      </div>
    </div>
  </section>
</main>


{{>footer}}