{{>header}}

<main class="main">
  <section id="projects" class="projects section">

    <div class="container" data-aos="fade-up">
      <div class="form-intro text-center mb-5 mt-4">
        <h1 style="font-weight: 700; color: #212529; text-transform: uppercase;">Ludoteca</h1>
        <p class="text-muted">Explora nuestra colección de juegos de mesa y rol</p>
        <hr style="width: 50px; margin: 20px auto; border-top: 3px solid #a71b12; opacity: 1;">
      </div>

      <div class="card shadow-sm border-0 p-3 bg-light mb-5">
        <form method="get" action="/games">
          <div class="row g-2 align-items-center">
            <div class="col-lg-3 col-md-4">
              <input name="name" class="form-control" type="search" placeholder="Buscar por nombre..." value="{{name}}">
            </div>
            <div class="col-lg-2 col-md-4">
              <select name="tag" class="form-select">
                <option value="">Categoría</option>
                <option value="Cartas">Cartas</option>
                <option value="Estrategia">Estrategia</option>
              </select>
            </div>
            <div class="col-lg-1 col-md-2">
              <select name="players" class="form-select">
                <option value="">Jug.</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">+5</option>
              </select>
            </div>
            <div class="col-lg-2 col-md-2">
              <select name="duration" class="form-select">
                <option value="">Duración</option>
                <option value="20">20 min</option>
                <option value="30">30+ min</option>
              </select>
            </div>

            <div class="col-lg-2 col-md-6">
              <button class="btn_lcdd w-100 d-flex align-items-center justify-content-center" type="submit"
                style="height: 38px; border: none;">
                <i class="bi bi-search me-2"></i> Buscar
              </button>
            </div>

            {{#admin}}
            <div class="col-lg-2 col-md-6">
              <a href="/game_form"
                class="btn_lcdd_black w-100 text-decoration-none d-flex align-items-center justify-content-center"
                style="height: 38px;">
                <i class="bi bi-plus-circle me-2"></i> Crear
              </a>
            </div>
            {{/admin}}
          </div>
        </form>
      </div>

      <div id="games-container" class="row gy-4">
        {{#game}}
        <div class="col-lg-4 col-md-6 game-item">
          <div class="project-card h-100 shadow-sm border-0">
            <a href="/game/{{gameId}}" class="text-decoration-none">
              <div class="project-image" style="height: 220px; overflow: hidden;">
                <img src="/images/{{gameImage.id}}" alt="{{gameName}}" class="img-fluid w-100 h-100"
                  style="object-fit: cover;">
              </div>
              <div class="project-info p-3">
                <div class="project-category mb-2 fw-bold" style="color: #a71b12; font-size: 0.8rem;">{{genre}}</div>
                <h4 class="project-title text-dark">{{gameName}}</h4>
                <p class="project-description text-muted small"
                  style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                  {{gameDescription}}
                </p>
              </div>
            </a>
          </div>
        </div>
        {{/game}}

        {{^game}}
        <div class="col-12 text-center py-5">
          <i class="bi bi-search-heart fs-1 text-muted"></i>
          <p class="mt-3 text-muted">No hemos encontrado juegos con esos filtros.</p>
          <a href="/games" class="btn btn-link text-danger">Limpiar filtros</a>
        </div>
        {{/game}}
      </div>

      <div class="text-center mt-5 mb-5">
        {{#hasNext}}
        <button id="load-more-games-btn" class="btn-load-more" onclick="loadMoreGames()">
          <span id="btn-games-text">Cargar más juegos</span>
          <span id="btn-games-spinner" class="spinner-border spinner-border-sm d-none" role="status"></span>
        </button>
        {{/hasNext}}
      </div>
    </div>
  </section>
</main>

{{>footer}}