{{>header}}

<main class="main">
  <section id="admin-dashboard" class="quote section">
    <div class="container" data-aos="fade-up">

      <div class="form-intro text-center mb-5">
        <h1 style="font-weight: 700; color: #212529;">Panel de Administración</h1>
        <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-center">
            <li class="breadcrumb-item"><a href="/" class="text-decoration-none text-muted">Inicio</a></li>
            <li class="breadcrumb-item active" aria-current="page" style="color: #a71b12; font-weight: 600;">
              Administración</li>
          </ol>
        </nav>
      </div>

      <div class="admin-section mb-5">
        <div class="d-flex align-items-center mb-4 border-bottom pb-2">
          <i class="bi bi-clipboard-check text-primary fs-3 me-3"></i>
          <h3 class="mb-0" style="font-weight: 700;">Solicitudes Pendientes</h3>
        </div>

        <div class="row gy-4">
          <h6 class="fw-bold mb-3">Eventos</h6>
          {{#events}}
          <div class="col-lg-4 col-md-6" data-aos="fade-up">
            <div class="project-card shadow-sm border-0 h-100">
              <a class="d-block text-decoration-none" href="/event/{{eventId}}">
                <div class="project-image" style="height: 180px; overflow: hidden;">
                  <img src="/images/{{eventImage.id}}" alt="Evento" class="img-fluid w-100 h-100"
                    style="object-fit: cover;">
                </div>
                <div class="project-info p-3">
                  <div class="project-category mb-2">{{eventTag}}</div>
                  <h4 class="project-title">{{eventName}}</h4>
                  <p class="text-muted small mb-0"
                    style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                    {{eventDescription}}
                  </p>
                </div>
              </a>
              <div class="p-3 pt-0 d-flex gap-2">
                <form method="post" action="/admin/approveEvent/{{eventId}}" class="flex-grow-1">
                  <input type="hidden" name="_csrf" value="{{token}}">
                  <button type="submit" class="btn btn-success w-100 rounded-pill btn-sm">Aprobar</button>
                </form>
                <form method="post" action="/admin/rejectEvent/{{eventId}}" class="flex-grow-1">
                  <input type="hidden" name="_csrf" value="{{token}}">
                  <button type="submit" class="btn btn-outline-danger w-100 rounded-pill btn-sm">Rechazar</button>
                </form>
              </div>
            </div>
          </div>
          {{/events}}

          {{^events}}
          <div class="col-12 text-center py-4 bg-light rounded-3 border border-dashed">
            <p class="mb-0 text-muted italic">No hay solicitudes pendientes.</p>
          </div>
          {{/events}}

          <h6 class="fw-bold mb-3">Noticias</h6>
          {{#news}}
          <div class="col-lg-4 col-md-6" data-aos="fade-up">
            <div class="project-card shadow-sm border-0 h-100">
              <a class="d-block text-decoration-none" href="/news/{{newId}}">
                <div class="project-image" style="height: 180px; overflow: hidden;">
                  <img src="/images/{{newImage.id}}" alt="Noticia" class="img-fluid w-100 h-100"
                    style="object-fit: cover;">
                </div>
                <div class="project-info p-3">
                  <div class="project-category mb-2">{{newTag}}</div>
                  <h4 class="project-title">{{newName}}</h4>
                  <p class="text-muted small mb-0"
                    style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                    {{newDescription}}
                  </p>
                </div>
              </a>
              <div class="p-3 pt-0 d-flex gap-2">
                <form method="post" action="/admin/approveNew/{{newId}}" class="flex-grow-1">
                  <input type="hidden" name="_csrf" value="{{token}}">
                  <button type="submit" class="btn btn-success w-100 rounded-pill btn-sm">Aprobar</button>
                </form>
                <form method="post" action="/admin/rejectNew/{{newId}}" class="flex-grow-1">
                  <input type="hidden" name="_csrf" value="{{token}}">
                  <button type="submit" class="btn btn-outline-danger w-100 rounded-pill btn-sm">Rechazar</button>
                </form>
              </div>
            </div>
          </div>
          {{/news}}
          {{^news}}
          <div class="col-12 text-center py-4 bg-light rounded-3 border border-dashed">
            <p class="mb-0 text-muted italic">No hay solicitudes pendientes.</p>
          </div>
          {{/news}}
        </div>
      </div>

      <div class="admin-section mb-5">
        <div class="d-flex align-items-center mb-4 border-bottom pb-2">
          <i class="bi bi-people text-primary fs-3 me-3"></i>
          <h3 class="mb-0" style="font-weight: 700;">Usuarios Registrados</h3>
        </div>
        <div class="row gy-3">
          {{#users}}
          <div class="col-xl-3 col-lg-4 col-md-6">
            <a href="/user/{{userId}}"
              class="d-flex align-items-center p-2 shadow-sm border rounded text-decoration-none bg-white h-100">
              <div class="flex-shrink-0" style="width: 50px; height: 50px;">
                {{#userImage}}
                <img src="/images/{{id}}" class="rounded-circle w-100 h-100" style="object-fit: cover;">
                {{/userImage}}
                {{^userImage}}
                <img src="/img/person/Portrait_Placeholder.png" class="rounded-circle w-100 h-100"
                  style="object-fit: cover;">
                {{/userImage}}
              </div>
              <div class="flex-grow-1 ms-3 overflow-hidden">
                <h6 class="mb-0 text-dark fw-bold text-truncate">{{userNickname}}</h6>
                <small class="text-muted text-truncate d-block">{{userEmail}}</small>
              </div>
            </a>
          </div>
          {{/users}}
        </div>
      </div>

      <div class="admin-section">
        <div class="d-flex align-items-center mb-4 border-bottom pb-2">
          <i class="bi bi-graph-up-arrow text-primary fs-3 me-3"></i>
          <h3 class="mb-0" style="font-weight: 700;">Estadísticas</h3>
        </div>
        <div class="row gy-4">
          <div class="col-lg-6">
            <div class="card border-0 shadow-sm p-3">
              <h6 class="fw-bold mb-3"><i class="bi bi-controller me-2"></i>Juegos Favoritos</h6>
              <div style="height: 300px;"><canvas id="gamesFavChart"></canvas></div>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="card border-0 shadow-sm p-3">
              <h6 class="fw-bold mb-3"><i class="bi bi-calendar-check me-2"></i>Participación en Eventos</h6>
              <div style="height: 300px;"><canvas id="eventsParticipantsChart"></canvas></div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>
</main>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

{{>footer}}