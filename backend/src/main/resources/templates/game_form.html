{{>header}}
<main class="main">
  <section id="quote" class="quote section pt-0">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="quote-form">

            <div class="form-intro">
              <h3>
                {{#game.gameId}}Modificar{{/game.gameId}}
                {{^game.gameId}}Añadir{{/game.gameId}}
                un juego
              </h3>
              <p>
                {{#game.gameId}}Modifica los datos del juego seleccionado.{{/game.gameId}}
                {{^game.gameId}}Rellena los campos para registrar un nuevo juego.{{/game.gameId}}
              </p>
            </div>

            {{#hasErrors}}
            <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert"
              style="border-left: 5px solid #890f00;">
              <strong><i class="bi bi-exclamation-triangle-fill me-2"></i> Ups! Hay errores:</strong>

              <ul class="mt-2 mb-0">
                {{#allErrors}}
                <li>{{.}}</li>
                {{/allErrors}}
              </ul>
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {{/hasErrors}}

            <form method="post" action="/game_form" enctype="multipart/form-data"
              class="custom-login-form needs-validation" novalidate>

              {{#game}}
              <div class="form">
                <input type="hidden" name="gameId" value="{{#gameId}}{{gameId}}{{/gameId}}" />

                <div class="form-field">
                  <label for="gameName" class="required-label">Nombre del Juego:</label>
                  <input type="text" name="gameName" id="gameName" value="{{#gameName}}{{gameName}}{{/gameName}}"
                    class="form-control" minlength="2" maxlength="100" required>
                  <div class="invalid-feedback">
                    El nombre del juego debe tener entre 2 y 100 caracteres.
                  </div>
                </div>
                <br>

                <div class="form-field full-width">
                  <label for="gameDescription" class="required-label">Descripción:</label>
                  <textarea name="gameDescription" id="gameDescription" rows="5" class="form-control" minlength="10"
                    maxlength="2000" required>{{#gameDescription}}{{gameDescription}}{{/gameDescription}}</textarea>
                  <div class="invalid-feedback">
                    La descripción del juego debe tener entre 10 y 2000 caracteres.
                  </div>
                </div>
                <br>

                <div class="form-field">
                  <label for="genre" class="required-label">Género:</label>
                  <input type="text" name="genre" id="genre" value="{{#genre}}{{genre}}{{/genre}}" class="form-control"
                    minlength="3" maxlength="50" required>
                  <div class="invalid-feedback">
                    El género del juego debe tener entre 3 y 50 caracteres.
                  </div>
                </div>
                <br>

                <div class="row mt-4 p-3 mb-2 bg-light rounded border">
                  <div class="col-12 mb-2">
                    <h6 class="text-primary border-bottom">Jugadores</h6>
                  </div>
                  <div class="col-md-6 form-field">
                    <label for="minPlayers">Mínimo:</label>
                    <input type="number" name="minPlayers" id="minPlayers"
                      value="{{#minPlayers}}{{minPlayers}}{{/minPlayers}}" class="form-control" min="1" required>
                    <div class="invalid-feedback">
                      El número mínimo de jugadores debe ser mayor o igual a 1.
                    </div>
                  </div>
                  <div class="col-md-6 form-field">
                    <label for="maxPlayers">Máximo:</label>
                    <input type="number" name="maxPlayers" id="maxPlayers"
                      value="{{#maxPlayers}}{{maxPlayers}}{{/maxPlayers}}" class="form-control" min="1" required>
                    <div class="invalid-feedback">
                      El número máximo de jugadores debe ser mayor o igual a 1.
                    </div>
                  </div>
                </div>
                <br>

                <div class="row mt-3 p-3 mb-2 bg-light rounded border">
                  <div class="col-12 mb-2">
                    <h6 class="text-primary border-bottom">Duración (minutos)</h6>
                  </div>
                  <div class="col-md-6 form-field">
                    <label for="minDuration">Mínima:</label>
                    <input type="number" name="minDuration" id="minDuration"
                      value="{{#minDuration}}{{minDuration}}{{/minDuration}}" class="form-control" min="1" required>
                    <div class="invalid-feedback">
                      La duración mínima debe ser mayor o igual a 1 minuto.
                    </div>
                  </div>
                  <div class="col-md-6 form-field">
                    <label for="maxDuration">Máxima:</label>
                    <input type="number" name="maxDuration" id="maxDuration"
                      value="{{#maxDuration}}{{maxDuration}}{{/maxDuration}}" class="form-control" min="1" required>
                    <div class="invalid-feedback">
                      La duración máxima debe ser mayor o igual a 1 minuto.
                    </div>
                  </div>
                </div>
                <br>

                <div class="form-field">
                  <label for="imageField" class="required-label">Imagen de portada:</label>
                  {{#gameId}}
                  <input type="file" name="imageField" id="imageField" class="form-control"
                    accept=".jpg, .jpeg, .png, .webp">
                  {{/gameId}}

                  {{^gameId}}
                  <input type="file" name="imageField" id="imageField" class="form-control"
                    accept=".jpg, .jpeg, .png, .webp" required>
                  {{/gameId}}
                  <div class="invalid-feedback">
                    La imagen de portada debe ser un archivo válido (JPG, PNG, WEBP).
                  </div>
                </div>

              </div>
              {{/game}}

              <div class="d-flex flex-column flex-md-row justify-content-evenly mt-5 mb-2">
                <a href="/games" class="submit-btn"
                  style="background: #6c757d; margin-top: 0; justify-content: center; display: flex; text-decoration: none;">
                  <i class="bi bi-arrow-left"></i>
                  <span class="ms-2">Atrás</span>
                </a>
                <button type="submit" class="submit-btn" style="margin-top: 0; justify-content: center; display: flex;">
                  <span class="me-2">Guardar Juego</span>
                  <i class="bi bi-check2-circle"></i>
                </button>
              </div>

              <input type="hidden" name="_csrf" value="{{token}}" />
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>
{{>footer}}